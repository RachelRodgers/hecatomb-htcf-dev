Author: Scott A. Handley (shandley@wustl.edu)

Description: Scripts used to clean, cluster and assign taxonomy to
reads generatged using a RdAB-Virome protocol from a Viral-Like Particle
(VLP) preperation.

	- Additional helper scripts can be found in ../accessory

# All scripts should be launched from the base data directory containing
all demultiplexed *.fastq.gz (R1 & R2) that you wish to analyze.

# RUN ORDER:

1) contaminant_removal.sh

Nine step script that removes non-biological sequences (combinations of
adapters and primer sequences). Also removes host (change host path if
different than the default (human)), common vector contaminants (PhiX and
NCBI UniVecDB) and bacterial sequences. The bacterial reference sequence
database is a collection of human associated gut bacterial genomes as well
as large dsDNA viruses that have been masked of potential virus sequences.

2) cluster_count.sh

First, this script removes exact duplicates based on the assumption that
an exact duplicate is more likley to be a PCR duplicate instead of an
exact duplicate generated by chance from the random library generation
process.

Second, sequences are dereplicated at based on a sequence identity
thrshold allowing 4 subsitutions (s=4, substitions only, no indels). In
other words, sequences 1, 2, 3, or 4 bases apart will be clustered while
5+ substituions will belong to a new cluster. Allowing 4 substituions was
somewhat subjectively selected after some empiric testing. Importantly,
step 3 of this script accounts for the number of sequences clustered into
a 'count table'. Thus, if 100 sequences clustered based on an s=5 that
sequence will be counted (100) in the seqtable. If you are concerned
with your value of s=X it can easily be changed and rerun. However,
the sequences will always be accounted for.

Third, the script extracts the single highest quality representative
and outputs this into a fasta file.

Fourth, the script creates a counts table based on the clustering (and
s=X value as discussed above).

3) seqtable_merge.sh

An Rscript that merges individual counts tables from cluster_count.sh. Each row is a sequence, each column a sample and each cell a count of the number of times that sequence appeared.

4) mmseqs_pviral_aa.sh

5) mmseqs_pviral_aa_check.sh

6) mmseqs_pviral_nt.sh

7) mmseqs_pviral_nt_annotate.sh

8) mmseqs_nt_check.sh

9) mmseqs_nt_check_annotate.sh

10) concatenate_results.sh

*) qiive_cleanup.sh

*Work in progress

# Description of additional files

- phage_taxonomic_lineages.txt: A simple list file of all major
bacteriophage taxonomic lineages. Useful for parsing phage from non-phage
output.

